package types

import (
	"testing"
)

func FuzzDecodeValue(f *testing.F) {
	// Valid inputs
	f.Add("0x0000000000000000000000000000000000000000000000056a6418b505860000", "uint256")
	f.Add("0x0000000000000000000000000000000000000000000000000000000000000001", "bool")
	f.Add("0x0000000000000000000000000000000000000000000000000000000000000009", "int8")
	f.Add("0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000011ca06aa780ce89dbbf5d8f5fa8bf6965be942c9", "address[]")
	f.Add("240165a58dc0ace7184e6c49c06a510c7a31f40ebbcc6c5480eb9c98506b2d47000000000000000000000000dedc604896be034283365d65118cce2942f9939200000000000000000000000000000000000000000000000000000000627b5870000000000000000000000000000000000000000000000000000019a39a365a68", "(bytes32,address,uint256,uint256)")
	f.Add("0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001", "(uint256,uint256)[]")
	f.Add("0x3b696cbaa12880500df23f90cf5599987649df71fe24e830cc21fbb95891dbe7", "bytes32")
	// Edge cases
	f.Add("", "uint256")
	f.Add("0x", "uint256")
	f.Add("zzzz", "uint256")
	f.Add("00", "")
	f.Add("00", "notavalidtype")
	f.Add("", "(0)")
	f.Add("", "(,)")
	f.Add("", "(uint256,)")
	f.Add("", "()[]")
	f.Add("", "()")

	f.Fuzz(func(t *testing.T, value, datatype string) {
		_, _ = DecodeValue(value, datatype)
	})
}

func FuzzDecodeQueryType(f *testing.F) {
	f.Add([]byte{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x74, 0x65, 0x73, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xff})
	f.Add([]byte{})
	f.Add([]byte{0x00})
	f.Add([]byte{0xff, 0xff, 0xff, 0xff})

	f.Fuzz(func(t *testing.T, data []byte) {
		_, _, _ = DecodeQueryType(data)
	})
}
